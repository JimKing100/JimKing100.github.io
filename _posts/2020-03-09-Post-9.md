---
layout: post
title: A Marijuana Recommendation System Using TF-IDF and k-NN
subtitle: A Content-based Recommender Using NLP, TF-IDF, k-NN, Pickling and Dash
image: '/img/strains/weed.jpg'
comments: true
published: false
---

A content based recommender system works with user provided data to generate recommendations for the user.  Recommender systems can be used to personalize information for a user and are commonly used to recommend movies, books, restaurants, and other products and services.

Using the Marijuana Recommendation System below (or at the link [here][1]), we are going to use user selected effects and flavors to recommend five marijuana strains from a list of over 2,300 marijuana strains.  In our case, the product is marijuana and the features are a list of effects and flavors. 

<iframe src="https://strains-live.herokuapp.com" width="900" height="900" style="border: none;">
  
### A Word About the Code

All the code, data and associated files for the project can be accessed at my [GitHub][2].  The README file provides details of the repo directory and files.

### The TF-IDF Model Using k-NN

TF-IDF refers to Term Frequency-Inverse Document Frequency.  TF is simply the frequency a word appears in a document.  IDF is the inverse of the document frequency in the whole corpus of documents.  The idea behind the TF-IDF is to dampen the effect of high-frequency words in determing the importance of an item (document).

k-NN refers to K Nearest Neighbor and is a simple algorithm that, in our case, classifies data based on a similarity measure.  In other words, it selects the "nearest" matches for our user input. 

Let's step through an example using the [tf_knn.ipynb][3] notebook.  The basic steps are:

1. Load, Clean and Wrangle the Data
2. Tokenize and Vectorize the Features
3. Create the Document-Term Matrix(DTM)
4. Fit a Nearest Neighbors Model to the DTM
5. Obtain the Recommendations from the Model

#### Load, Clean and Wrangle the Data

```
df = pd.read_csv("https://raw.githubusercontent.com/JimKing100/strains-live/master/data/cannabis.csv")
df = df.dropna()
df = df.reset_index(drop=True)
df['Criteria'] = df['Effects'] + ',' + df['Flavor']
```

![strains DataFrame](/img/strains/df.png)

#### Tokenize and Vectorize the Features

```
tf = TfidfVectorizer(stop_words='english')
dtm = tf.fit_transform(df['Criteria'].values.astype('U'))
dtm = pd.DataFrame(dtm.todense(), columns=tf.get_feature_names())
```

![dtm DataFrame](/img/strains/dtm.png)

#### Create the Document-Term Matrix

```

```

#### Fit a Nearest Neighbors Model

```

```

#### Obtain the Recommendations

```

```

*Marijuana Data Source: Cannabis Strains Marijuana Dataset from LiamLarsen in Kaggle*

[1]: <https://strains-live.herokuapp.com>
[2]: <https://github.com/JimKing100/strains-live>
[3]: <https://github.com/JimKing100/strains-live/blob/master/model/tf_knn.ipynb>

